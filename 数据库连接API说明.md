# ğŸ—„ï¸ æ•°æ®åº“è¿æ¥APIè¯´æ˜

## ğŸ“‹ **æ¦‚è¿°**

æœ¬é¡¹ç›®å·²ç»å®Œæˆäº†å‰åç«¯æ•°æ®åº“è¿æ¥çš„å®Œæ•´å®ç°ï¼ŒåŒ…æ‹¬ï¼š

- âœ… ç”¨æˆ·ç®¡ç†APIï¼ˆè€äººç”¨æˆ·CRUDï¼‰
- âœ… å¥åº·æ•°æ®APIï¼ˆå®æ—¶å¥åº·æ•°æ®ã€å†å²è®°å½•ã€ç»Ÿè®¡ï¼‰
- âœ… è€äººå¥åº·æ¡£æ¡ˆAPI
- âœ… è®¤è¯ä¸­é—´ä»¶
- âœ… å‰ç«¯æœåŠ¡å±‚

## ğŸš€ **å¯åŠ¨æ­¥éª¤**

### **1. å¯åŠ¨åç«¯æœåŠ¡**

```bash
cd elder_care/server
npm install
npm run start:server
```

**åç«¯å°†åœ¨ http://localhost:3000 å¯åŠ¨**

### **2. å¯åŠ¨å‰ç«¯æœåŠ¡**

```bash
cd elder_care/apps/family-app
npm install
npm run dev
```

**å‰ç«¯å°†åœ¨ http://localhost:5173 å¯åŠ¨**

## ğŸ”Œ **APIæ¥å£åˆ—è¡¨**

### **ç”¨æˆ·ç®¡ç†**

| æ–¹æ³• | è·¯å¾„ | æè¿° | æƒé™ |
|------|------|------|------|
| `GET` | `/api/users/role/elderly` | è·å–è€äººç”¨æˆ·åˆ—è¡¨ | éœ€ç™»å½• |
| `GET` | `/api/users/:id` | è·å–ç”¨æˆ·ä¿¡æ¯ | éœ€ç™»å½• |
| `PUT` | `/api/users/:id` | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ | éœ€ç™»å½• |
| `DELETE` | `/api/users/:id` | åˆ é™¤ç”¨æˆ· | éœ€ç™»å½• |

### **å¥åº·æ•°æ®**

| æ–¹æ³• | è·¯å¾„ | æè¿° | æƒé™ |
|------|------|------|------|
| `GET` | `/api/health-records/:elderlyId/latest` | è·å–æœ€æ–°å¥åº·æ•°æ® | éœ€ç™»å½• |
| `GET` | `/api/health-records/:elderlyId/history` | è·å–å¥åº·å†å²è®°å½• | éœ€ç™»å½• |
| `POST` | `/api/health-records` | åˆ›å»ºå¥åº·è®°å½• | éœ€ç™»å½• |
| `PUT` | `/api/health-records/:id` | æ›´æ–°å¥åº·è®°å½• | éœ€ç™»å½• |
| `GET` | `/api/health-records/:elderlyId/stats` | è·å–å¥åº·ç»Ÿè®¡ | éœ€ç™»å½• |
| `GET` | `/api/health-records/:elderlyId/warnings` | è·å–å¥åº·è­¦å‘Š | éœ€ç™»å½• |

### **è€äººå¥åº·æ¡£æ¡ˆ**

| æ–¹æ³• | è·¯å¾„ | æè¿° | æƒé™ |
|------|------|------|------|
| `GET` | `/api/elderhealth/:elderlyId` | è·å–è€äººå¥åº·æ¡£æ¡ˆ | éœ€ç™»å½• |
| `GET` | `/api/elderhealth` | è·å–æ‰€æœ‰å¥åº·æ¡£æ¡ˆ | éœ€ç™»å½• |
| `POST` | `/api/elderhealth` | åˆ›å»ºæˆ–æ›´æ–°å¥åº·æ¡£æ¡ˆ | éœ€ç™»å½• |

### **è®¤è¯**

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| `POST` | `/api/auth/login` | ç”¨æˆ·ç™»å½• |
| `POST` | `/api/auth/register` | ç”¨æˆ·æ³¨å†Œ |
| `POST` | `/api/auth/create-elderly` | åˆ›å»ºè€äººç”¨æˆ· |
| `GET` | `/api/auth/profile` | è·å–ç”¨æˆ·ä¿¡æ¯ |

## ğŸ“Š **æ•°æ®åº“é›†åˆæ˜ å°„**

| å‰ç«¯åŠŸèƒ½ | åç«¯é›†åˆ | ä¸»è¦å­—æ®µ |
|----------|----------|----------|
| è€äººç®¡ç† | `users` | username, realname, phone, role, avatar, status |
| å¥åº·æ•°æ® | `health_data` | elderlyId, heartRate, bloodPressure, temperature, bloodSugar |
| å¥åº·æ¡£æ¡ˆ | `elder_health_archives` | elderID, name, age, medicals, allergies |
| å¥åº·è®°å½• | `health_records` | elderlyId, recordType, value, measuredAt |

## ğŸ”§ **å‰ç«¯æœåŠ¡ä½¿ç”¨**

### **è€äººç®¡ç†æœåŠ¡**

```typescript
import { ElderlyService } from '../services/elderly.service';

// è·å–è€äººåˆ—è¡¨
const elderlyList = await ElderlyService.getElderlyList();

// åˆ›å»ºè€äºº
const newElderly = await ElderlyService.createElderly({
  username: 'elderly_1234',
  password: '123456',
  phone: '13800138000',
  realname: 'å¼ çˆ·çˆ·'
});
```

### **å¥åº·æ•°æ®æœåŠ¡**

```typescript
import { HealthService } from '../services/health.service';

// è·å–å¥åº·æ•°æ®
const healthData = await HealthService.getHealthData('elderlyId');

// è·å–å¥åº·ç»Ÿè®¡
const stats = await HealthService.getHealthStats('elderlyId', 'month');
```

## ğŸ¯ **æµ‹è¯•å»ºè®®**

### **1. æµ‹è¯•è€äººç®¡ç†**
- è®¿é—® `/elderly` é¡µé¢
- å°è¯•æ·»åŠ æ–°è€äºº
- æŸ¥çœ‹è€äººåˆ—è¡¨æ˜¯å¦æ­£ç¡®æ˜¾ç¤º

### **2. æµ‹è¯•å¥åº·æ•°æ®**
- è®¿é—® `/health` é¡µé¢
- é€‰æ‹©ä¸åŒè€äººæŸ¥çœ‹å¥åº·æ•°æ®
- æµ‹è¯•AIå¥åº·å»ºè®®åŠŸèƒ½

### **3. æµ‹è¯•APIè¿æ¥**
- æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
- æŸ¥çœ‹Networkæ ‡ç­¾é¡µçš„APIè¯·æ±‚
- ç¡®è®¤è¿”å›æ•°æ®æ ¼å¼æ­£ç¡®

## âš ï¸ **æ³¨æ„äº‹é¡¹**

1. **æ•°æ®åº“è¿æ¥**ï¼šç¡®ä¿MongoDBæœåŠ¡æ­£åœ¨è¿è¡Œ
2. **ç¯å¢ƒå˜é‡**ï¼šæ£€æŸ¥`.env`æ–‡ä»¶ä¸­çš„æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
3. **ç«¯å£å†²çª**ï¼šç¡®ä¿3000ç«¯å£æœªè¢«å ç”¨
4. **CORSè®¾ç½®**ï¼šåç«¯å·²é…ç½®å…è®¸å‰ç«¯åŸŸåè®¿é—®

## ğŸ› **å¸¸è§é—®é¢˜**

### **Q: å‰ç«¯æ˜¾ç¤º"è·å–è€äººåˆ—è¡¨å¤±è´¥"**
**A:** æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼Œæ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸

### **Q: APIè¿”å›404é”™è¯¯**
**A:** ç¡®è®¤è·¯ç”±å·²æ­£ç¡®æ³¨å†Œï¼Œè·¯å¾„æ‹¼å†™æ­£ç¡®

### **Q: æ•°æ®åº“æŸ¥è¯¢æ— ç»“æœ**
**A:** æ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦æœ‰æµ‹è¯•æ•°æ®ï¼Œé›†åˆåç§°æ˜¯å¦æ­£ç¡®

## ğŸ“ **æŠ€æœ¯æ”¯æŒ**

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. åç«¯æ§åˆ¶å°é”™è¯¯æ—¥å¿—
2. å‰ç«¯æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
3. æ•°æ®åº“è¿æ¥çŠ¶æ€
4. APIè¯·æ±‚å’Œå“åº”æ•°æ®

---

**ğŸ‰ æ­å–œï¼æ‚¨çš„é¡¹ç›®ç°åœ¨å·²ç»å®Œå…¨è¿æ¥åˆ°çœŸå®æ•°æ®åº“äº†ï¼**
